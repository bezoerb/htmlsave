/*! htmlsave - v0.0.11 - 2014-07-22
* Copyright (c) 2014 Ben ZÃ¶rb; Licensed MIT */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.htmlsave=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";b.exports.slice=a("./modules/slice.js"),b.exports.truncate=a("./modules/truncate.js")},{"./modules/slice.js":2,"./modules/truncate.js":3}],2:[function(a,b){"use strict";var c=a("./utils.js"),d={breakword:!0,ellipsis:"..."};b.exports=function(a,b,e){var f,g,h,i=[],j=a.length,k=0,l="",m="",n=[],o=0,p=a.replace(/<[^>]*>/gm,"");if("object"!=typeof e)e=d;else for(var q in d)"undefined"==typeof e[q]&&(e[q]=d[q]);for(f=c.isArray(b)?Array.prototype.shift.call(b):b,g=0;j>g;g++){0!==g&&" "!==a[g]||m.length||e.breakword||(g>0&&(p=a.substr(g+1).replace(/<[^>]*>/gm,"")),o=p.indexOf(" "),0>o&&(o=p.length)),"<"===a[g]||m.length?(m+=a[g],">"===a[g]&&/<\//.test(m)?(l+=m,m="",n.pop()):">"===a[g]&&c.isVoidElement(m)?(l+=m,m=""):">"===a[g]&&(l+=m,n.push(m),m="")):(k++,l+=a[g]);var r=""===m&&(g<a.length-2&&"</"!==a.substr(g+1,2)||g>a.length-1),s=k+o>=f&&(e.breakword||c.canSplit(a,g,!!e.ellipsis));if(s&&r||g===j-1){var t="";for(c.isArray(b)&&b.length?f=Array.prototype.shift.call(b):c.isArray(b)&&(f=j),h=n.length-1;h>=0;h--){var u=n[h],v=u.match(/<\s*(\w+)\s*/)[1],w="</"+v+">";l+=w,t=u+t}i.push(l),l=t,k=0}}return i}},{"./utils.js":4}],3:[function(a,b){"use strict";var c=a("./utils.js"),d={breakword:!1,ellipsis:"..."};b.exports=function(a,b,e){var f,g,h=a.length,i=0,j="",k=0,l="",m=[],n=a.replace(/<[^>]*>/gm,"");if("object"!=typeof e)e=d;else for(var o in d)"undefined"==typeof e[o]&&(e[o]=d[o]);if(0===b)return"";if(0>b&&(b=n.length+b),"string"==typeof e.ellipsis&&(k=e.ellipsis.length,k>b&&(e.ellipsis=e.ellipsis.substr(0,b),k=e.ellipsis.length)),k>=b)throw"htmlsave.truncate: Maxlength is less or equal ellipsis length";for(f=0;h>f;f++){"<"===a[f]||l.length?(l+=a[f],">"===a[f]&&/<\//.test(l)?(j+=l,l="",m.pop()):">"===a[f]&&c.isVoidElement(l)?(j+=l,l=""):">"===a[f]&&(j+=l,m.push(l),l="")):(i++,j+=a[f]);var p=""===l&&(f<a.length-2&&"</"!==a.substr(f+1,2)||f>a.length-1),q=e.breakword?0:p&&c.findNextWhitespacePosition(a,f+1),r=i+q+k>b&&(e.breakword||c.canSplit(a,f));if(r&&p||f===h-1){if(" "===a[f]&&(j=j.substr(0,j.length-1),i--),i>b-k){var s=j.length+(b-(i+k));/^<?[^<]*>/.test(j.substr(s))?(j=j.substr(0,s).substr(0,j.lastIndexOf("<")),m.pop()):j=j.substr(0,s)}for(0===m.length&&e.ellipsis&&j.length<a.length&&(j+=e.ellipsis),g=m.length-1;g>=0;g--){var t=m[g],u=t.match(/<\s*(\w+)\s*/)[1],v="</"+u+">";g===m.length-1&&e.ellipsis&&(j+=e.ellipsis),j+=v}break}}return j}},{"./utils.js":4}],4:[function(a,b){"use strict";"use Strict";function c(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"===Object.prototype.toString.call(a)||!1}function d(a,b,c){if(0>=b||b>=a.length)return!1;if(" "===a[b])return!0;var d,e;return c?(d=(a.substr(0,b).match(/<\/([\w]+)\/?>?$/m)||["-","-"])[1],e=(a.substr(b+1).match(/^<?([\w]+)\/?>/m)||["-","-"])[1]):(d=(a.substr(0,b).match(/<\/?([\w]+)\/?>?$/m)||["-","-"])[1],e=(a.substr(b+1).match(/^<?\/?([\w]+)\/?>/m)||["-","-"])[1]),-1!==i.indexOf(d)||-1!==i.indexOf(e)?!0:!1}function e(a,b){var c=a.substr(b),d=/^[^<]*>/.test(c),e=new RegExp("</?((?:"+i.join(")|(?:")+"))"),f=c.match(e);if(d){var g=a.substr(a.substr(0,b).lastIndexOf("<")).match(/^<\/(\w+)/);if(g&&-1!==i.indexOf(g[1]))return 0;c=c.substr(c.indexOf(">")+1)}var j=h(c).indexOf(" "),k=f?h(c.substr(0,c.indexOf(f[0]))).length:j+1,l=Math.min(j,k);return l>=0?l:a.length}function f(a){var b=(a.match(/<(\w+)/)||["-","-"])[1];return-1!==i.indexOf(b)}function g(a){var b=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],c=(a.match(/<(\w+)/)||["-","-"])[1];return-1!==b.indexOf(c)}function h(a,b){b=(((b||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return a.replace(d,"").replace(c,function(a,c){return b.indexOf("<"+c.toLowerCase()+">")>-1?a:""})}var i=["address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","noscript","ol","output","p","pre","section","table","tfoot","ul","video"];b.exports.isArray=c,b.exports.canSplit=d,b.exports.isBlockLevelElement=f,b.exports.isVoidElement=g,b.exports.findNextWhitespacePosition=e,b.exports.stripTags=h},{}]},{},[1])(1)});